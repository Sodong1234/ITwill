# [오전수업] DB 17차

```
last_name컬럼의 오른쪽첫자리를 추출한 문자열이 'n'과 같은 행 출력
SELECT employee_id, CONCAT(first_name, last_name) name,
LENGTH(last_name), INSTR(last_name, 'a') "Contains 'a'?"
FROM employees
WHERE SUBSTR(last_name, -1, 1) = 'n';

EMPLOYEE_ID|NAME            |LENGTH(LAST_NAME)|Contains 'a'?|
-----------+----------------+-----------------+-------------+
        102|LexDe Haan      |                7|            5|
        105|DavidAustin     |                6|            0|
        110|JohnChen        |                4|            0|
        112|Jose ManuelUrman|                5|            4|
        123|ShantaVollman   |                7|            6|
        130|MozheAtkinson   |                8|            0|
        132|TJOlson         |                5|            0|
        133|JasonMallin     |                6|            2|
        151|DavidBernstein  |                9|            0|
        153|ChristopherOlsen|                5|            0|
…
```

## 숫자함수
- 숫자데이터를 입력받아 연산하는 함수
  - ROUND	: 입력 된 숫자에 대해서 반올림 연산하는 함수
  - TRUNC	: 입력 된 숫자에 대해서 버림 연산하는 함수
  - MOD	: 나눈 나머지 값을 구하는 함수

```
SELECT ROUND(45.926, 2), TRUNC(45.926, 2), MOD(1600, 300)
FROM dual;

ROUND(45.926,2)|TRUNC(45.926,2)|MOD(1600,300)|
---------------+---------------+-------------+
          45.93|          45.92|          100|
```

### ROUND|TRUNC
- ROUND|TRUNC(숫자, 연산자리값)
- 자리값은 소수점을 0으로 기준해서 양수는 소수점 아래로 음수면 소수점 위로 연산
```
정수부분의 반올림 시 자리값에 유의! (정수에서는 0을 생략할 수 없다)

SELECT ROUND(45.923, 2), ROUND(45.923, 0), ROUND(45.923, -1)
FROM dual;

ROUND(45.923,2)|ROUND(45.923,0)|ROUND(45.923,-1)|
---------------+---------------+----------------+
          45.92|             46|              50|



------------------------------------------------------------------------------

SELECT TRUNC(45.923,2), TRUNC(45.923), TRUNC(45.923, -1)
FROM dual;

TRUNC(45.923,2)|TRUNC(45.923)|TRUNC(45.923,-1)|
---------------+-------------+----------------+
          45.92|           45|              40|
```

### MOD
- 나머지 연산 함수
- MOD(나눠질수, 나누는 수)
```
SELECT last_name, salary, MOD(salary, 5000)
FROM employees
WHERE job_id = 'SA_REP';

LAST_NAME |SALARY|MOD(SALARY,5000)|
----------+------+----------------+
Tucker    | 10000|               0|
Bernstein |  9500|            4500|
Hall      |  9000|            4000|
Olsen     |  8000|            3000|
Cambrault |  7500|            2500|
Tuvault   |  7000|            2000|
King      | 10000|               0|
Sully     |  9500|            4500|
McEwen    |  9000|            4000|
Smith     |  8000|            3000|
Doran     |  7500|            2500|
Sewall    |  7000|            2000|
…


--------------------------------------------------------------------------------------------------


SELECT last_name, salary, TRUNC(salary/5000) "몫", MOD(salary, 5000) "나머지"
FROM employees
WHERE job_id = 'SA_REP';

LAST_NAME |SALARY|몫|나머지 |
----------+------+-+----+
Tucker    | 10000|2|   0|
Bernstein |  9500|1|4500|
Hall      |  9000|1|4000|
Olsen     |  8000|1|3000|
Cambrault |  7500|1|2500|
Tuvault   |  7000|1|2000|
King      | 10000|2|   0|
Sully     |  9500|1|4500|
McEwen    |  9000|1|4000|
Smith     |  8000|1|3000|
Doran     |  7500|1|2500|
Sewall    |  7000|1|2000|
…
```

- 연습문제 풀이
```

SELECT employee_id, last_name, salary,
ROUND(1.155*salary, 0) "New Salary", 
ROUND(1.155*salary - salary, 0) "Increase"
FROM employees;

EMPLOYEE_ID|LAST_NAME  |SALARY|New Salary|Increase|
-----------+-----------+------+----------+--------+
        100|King       | 24000|     27720|    3720|
        101|Kochhar    | 17000|     19635|    2635|
        102|De Haan    | 17000|     19635|    2635|
        103|Hunold     |  9000|     10395|    1395|
        104|Ernst      |  6000|      6930|     930|
        105|Austin     |  4800|      5544|     744|
        106|Pataballa  |  4800|      5544|     744|
        107|Lorentz    |  4200|      4851|     651|
        108|Greenberg  | 12008|     13869|    1861|
        109|Faviet     |  9000|     10395|    1395|
        110|Chen       |  8200|      9471|    1271|
        111|Sciarra    |  7700|      8894|    1194|
        112|Urman      |  7800|      9009|    1209|
        113|Popp       |  6900|      7970|    1070|
…


-----------------------------------------------------------------


SELECT last_name, LPAD(salary, 15, '$') salary
FROM employees;

LAST_NAME  |SALARY         |
-----------+---------------+
King       |$$$$$$$$$$24000|
Kochhar    |$$$$$$$$$$17000|
De Haan    |$$$$$$$$$$17000|
Hunold     |$$$$$$$$$$$9000|
Ernst      |$$$$$$$$$$$6000|
Austin     |$$$$$$$$$$$4800|
Pataballa  |$$$$$$$$$$$4800|
Lorentz    |$$$$$$$$$$$4200|
Greenberg  |$$$$$$$$$$12008|
Faviet     |$$$$$$$$$$$9000|
```

## 날짜함수
- 날짜데이터를 입력받아 연산하는 함수

### SYSDATE
- 현재 접속 중인 DB서버의 시간값을 날짜데이터로 돌려주는 함수
```

SELECT SYSDATE
FROM dual;

SYSDATE                |
-----------------------+
2022-04-04 12:17:26.000|
```

### 날짜의 산술연산
- 날짜 + 숫자
  - 날짜의 산술연산에서 숫자 1의 크기는 하루의 크기와 같다
  - 더한 숫자의 크기만큼 이후의 날짜가 출력된다.
```
SELECT SYSDATE, SYSDATE + 1
FROM dual;

SYSDATE                |SYSDATE+1              |
-----------------------+-----------------------+
2022-04-04 12:24:04.000|2022-04-05 12:24:04.000|
```
- 날짜 - 숫자
  - 뺀 숫자의 크기만큼 이전의 날짜가 출력된다.
```  
SELECT SYSDATE, SYSDATE - 1
FROM dual;

SYSDATE                |SYSDATE-1              |
-----------------------+-----------------------+
2022-04-04 12:25:38.000|2022-04-03 12:25:38.000|
```
- 날짜 - 날짜
  - 날짜 - 날짜의 연산에서는 두 날짜 간 차이나는 일 수 만큼이 숫자로 출력된다.
```  
SELECT SYSDATE - (SYSDATE - 7)
FROM dual;

SYSDATE-(SYSDATE-7)|
-------------------+
                  7|

--------------------------------------------------------------------------


이전 날짜에서 이후 날짜를 빼는 경우 음수의 결과가 출력된다.
SELECT (SYSDATE - 7) - SYSDATE 
FROM dual;

(SYSDATE-7)-SYSDATE|
-------------------+
                 -7|

```

- 날짜 + 숫자/24
  - 날짜에서 숫자 1의 크기는 하루
  - 1시간의 크기는 1/24

```
SELECT SYSDATE, SYSDATE + 1/24
FROM dual;

SYSDATE                |SYSDATE+1/24           |
-----------------------+-----------------------+
2022-04-04 12:34:50.000|2022-04-04 13:34:50.000|


-------------------------------------------------------------------


5시간 이후 연산
SELECT SYSDATE, SYSDATE + 5/24
FROM dual;

SYSDATE                |SYSDATE+5/24           |
-----------------------+-----------------------+
2022-04-04 12:36:45.000|2022-04-04 17:36:45.000|


-------------------------------------------------------------------


1시간을 60으로 나누면 1분이 된다.
1분 이후 시간 연산
SELECT SYSDATE, SYSDATE + 1/24/60
FROM dual;

SYSDATE                |SYSDATE+1/24/60        |
-----------------------+-----------------------+
2022-04-04 12:37:46.000|2022-04-04 12:38:46.000|


-------------------------------------------------------------------


1분은 60초
1초 이후 시간 연산
SELECT SYSDATE, SYSDATE + 1/24/60/60
FROM dual;

SYSDATE                |SYSDATE+1/24/60/60     |
-----------------------+-----------------------+
2022-04-04 12:39:31.000|2022-04-04 12:39:32.000|
```
```
SELECT last_name, (SYSDATE-hire_date)/7 AS WEEKS
FROM employees
WHERE department_id = 90;

LAST_NAME|WEEKS                                    |
---------+-----------------------------------------+
King     | 980.933422619047619047619047619047619048|
Kochhar  |  862.79056547619047619047619047619047619|
De Haan  |1107.361994047619047619047619047619047619|


---------------------------------------------------------------------


SELECT last_name, (SYSDATE-hire_date)/365 AS YEARS
FROM employees
WHERE department_id = 90;

LAST_NAME|YEARS                                    |
---------+-----------------------------------------+
King     |18.81241853754439370877727042110603754439|
Kochhar  |16.54666511288685946220192795535261288686|
De Haan  |21.23707607179096905124302384576357179097|
```


# [오후수업] JAVA 29차
